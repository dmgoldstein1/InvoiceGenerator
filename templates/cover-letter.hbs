<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cover Letter</title>
    <style>
        /* Generated by GitHub Copilot (GPT-4o) - Professional Cover Letter Styling */
        
        @page {
            margin: 0.75in;
            size: letter;
        }
        
        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 1.4;
            color: #000;
            margin: 0;
            padding: 0;
        }
        
        .letterhead {
            text-align: center;
            margin-bottom: 1.5in;
            border-bottom: 2px solid #333;
            padding-bottom: 0.5in;
        }
        
        .from-name {
            font-size: 16pt;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.1in;
        }
        
        .from-title {
            font-size: 11pt;
            font-style: italic;
            color: #666;
            margin-bottom: 0.2in;
        }
        
        .from-contact {
            font-size: 10pt;
            color: #444;
            line-height: 1.2;
        }
        
        .from-contact div {
            margin-bottom: 0.05in;
        }
        
        .date {
            text-align: right;
            margin-bottom: 1in;
            font-size: 11pt;
        }
        
        .to-section {
            margin-bottom: 1in;
        }
        
        .to-name {
            font-weight: bold;
            font-size: 11pt;
        }
        
        .to-company {
            font-style: italic;
            font-size: 11pt;
            margin-bottom: 0.1in;
        }
        
        .to-address {
            font-size: 10pt;
            line-height: 1.3;
        }
        
        .greeting {
            margin-bottom: 0.5in;
            font-size: 11pt;
        }
        
        .body {
            margin-bottom: 1in;
            font-size: 11pt;
            line-height: 1.6;
            text-align: justify;
        }
        
        .body p {
            margin-bottom: 0.3in;
            text-indent: 0;
        }
        
        .closing {
            margin-bottom: 0.5in;
            font-size: 11pt;
        }
        
        .signature {
            font-size: 11pt;
            font-weight: bold;
        }
        
        .cc-section {
            margin-top: 1in;
            border-top: 1px solid #ccc;
            padding-top: 0.3in;
            font-size: 10pt;
        }
        
        .cc-header {
            font-weight: bold;
            margin-bottom: 0.2in;
        }
        
        .cc-list {
            line-height: 1.4;
        }
        
        .cc-contact {
            margin-bottom: 0.1in;
        }
    </style>
</head>
<body>
    <div class="letterhead">
        <div class="from-name">{{invoice_details.from_contact.name}}</div>
        <div class="from-title">{{invoice_details.from_contact.title}}</div>
        <div class="from-contact">
            <div>{{invoice_details.from_contact.address}}</div>
            <div>{{invoice_details.from_contact.phone}}</div>
            <div>{{invoice_details.from_contact.email}}</div>
        </div>
    </div>
    
    <div class="date">
        {{formatDate invoice_details.invoice_date}}
    </div>
    
    <div class="to-section">
        <div class="to-name">{{invoice_details.to_contact.name}}</div>
        {{#if invoice_details.to_contact.company}}
        <div class="to-company">{{invoice_details.to_contact.company}}</div>
        {{/if}}
        <div class="to-address">
            {{invoice_details.to_contact.address}}<br>
            {{invoice_details.to_contact.phone}}<br>
            {{invoice_details.to_contact.email}}
        </div>
    </div>
    
    <div class="greeting">
        {{cover_letter.greeting}}
    </div>
    
    <div class="body">
        {{#each (split cover_letter.body '\n\n')}}
        <p>{{this}}</p>
        {{/each}}
    </div>
    
    <div class="closing">
        {{cover_letter.closing}}
    </div>
    
    <div class="signature">
        {{cover_letter.signature}}
    </div>
    
    {{#if invoice_details.cc_contacts}}
    <div class="cc-section">
        <div class="cc-header">CC:</div>
        <div class="cc-list">
            {{#each invoice_details.cc_contacts}}
            <div class="cc-contact">{{this.name}} - {{this.email}}</div>
            {{/each}}
        </div>
    </div>
    {{/if}}
</body>
</html>
